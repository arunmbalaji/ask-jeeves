{"version":3,"sources":["project/ProjectUtils.js"],"names":["async","file","await","fsp","stat","isFile","e","fileExistsAsync","projectRoot","appJson","path","join","expJson","_findConfigPathAsync","let","configPath","customConfigPaths","configName","basename","configNamespace","findConfigFileAsync","configFilenameAsync","expRcPath","fs","existsSync","json5","readAsync","logError","toString","readExpRcAsync","setCustomConfigPath","exp","pkg","isJsonFileError","message","startsWith","cause","packageJsonPath","nodeModulesPath","resolve","name","slug","toLowerCase","version","readConfigJsonAsync","logWithLevel","logDebug","logInfo","logWarning","clearNotification","attachLoggerStream","MAX_MESSAGE_LENGTH","_projectRootToLogger","_getLogger","logger","Logger","child","type","project","level","object","msg","id","useRedux","Config","useReduxNotifications","debug","info","warn","error","state","store","dispatch","actions","notifications","add","tag","truncatedMessage","length","substring","Analytics","logEvent","clear","stream","addStream"],"mappings":"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","file":"../../project/ProjectUtils.js","sourcesContent":["/**\n * @flow\n */\n\nimport fs from 'fs';\nimport fsp from 'mz/fs';\nimport path from 'path';\n\nimport JsonFile from '@expo/json-file';\nimport slug from 'slugify';\n\nimport * as Analytics from '../Analytics';\nimport Config from '../Config';\nimport Logger from '../Logger';\nimport * as state from '../state';\n\nimport * as Sentry from '../Sentry';\n\nconst MAX_MESSAGE_LENGTH = 200;\nlet _projectRootToLogger = {};\n\nfunction _getLogger(projectRoot: string) {\n  let logger = _projectRootToLogger[projectRoot];\n  if (!logger) {\n    logger = Logger.child({\n      type: 'project',\n      project: path.resolve(projectRoot),\n    });\n    _projectRootToLogger[projectRoot] = logger;\n  }\n\n  return logger;\n}\n\nexport function logWithLevel(\n  projectRoot: string,\n  level: string,\n  object: any,\n  msg: string,\n  id: ?string\n) {\n  let useRedux = id && Config.useReduxNotifications;\n\n  let logger = _getLogger(projectRoot);\n  switch (level) {\n    case 'debug':\n      logger.debug(object, msg);\n      break;\n    case 'info':\n      logger.info(object, msg);\n      break;\n    case 'warn':\n      if (!useRedux) {\n        logger.warn(object, msg);\n      }\n      break;\n    case 'error':\n      if (!useRedux) {\n        logger.error(object, msg);\n      }\n      break;\n    default:\n      logger.debug(object, msg);\n      break;\n  }\n\n  if (useRedux && (level === 'warn' || level === 'error')) {\n    state.store.dispatch(state.actions.notifications.add(projectRoot, id, msg, projectRoot, level));\n  }\n}\n\nexport function logDebug(projectRoot: string, tag: string, message: string, id: ?string) {\n  _getLogger(projectRoot).debug({ tag }, message.toString());\n}\n\nexport function logInfo(projectRoot: string, tag: string, message: string, id: ?string) {\n  if (id && Config.useReduxNotifications) {\n    state.store.dispatch(state.actions.notifications.add(projectRoot, id, message, tag, 'info'));\n  } else {\n    _getLogger(projectRoot).info({ tag }, message.toString());\n  }\n}\n\nexport function logError(projectRoot: string, tag: string, message: string, id: ?string) {\n  if (id && Config.useReduxNotifications) {\n    state.store.dispatch(state.actions.notifications.add(projectRoot, id, message, tag, 'error'));\n  } else {\n    _getLogger(projectRoot).error({ tag }, message.toString());\n  }\n\n  let truncatedMessage = message.toString();\n  if (truncatedMessage.length > MAX_MESSAGE_LENGTH) {\n    truncatedMessage = truncatedMessage.substring(0, MAX_MESSAGE_LENGTH);\n  }\n\n  // temporarily remove sentry until we can trim events\n  // send error to Sentry\n  // Sentry.logError(message.toString(), {\n  //   tags: { tag },\n  // });\n}\n\nexport function logWarning(projectRoot: string, tag: string, message: string, id: ?string) {\n  if (id && Config.useReduxNotifications) {\n    state.store.dispatch(state.actions.notifications.add(projectRoot, id, message, tag, 'warn'));\n  } else {\n    _getLogger(projectRoot).warn({ tag }, message.toString());\n  }\n\n  let truncatedMessage = message.toString();\n  if (truncatedMessage.length > MAX_MESSAGE_LENGTH) {\n    truncatedMessage = truncatedMessage.substring(0, MAX_MESSAGE_LENGTH);\n  }\n  Analytics.logEvent('Project Warning', {\n    projectRoot,\n    tag,\n    message: truncatedMessage,\n  });\n}\n\nexport function clearNotification(projectRoot: string, id: string) {\n  if (Config.useReduxNotifications) {\n    state.store.dispatch(state.actions.notifications.clear(projectRoot, id));\n  }\n}\n\nexport function attachLoggerStream(projectRoot: string, stream: any) {\n  _getLogger(projectRoot).addStream(stream);\n}\n\nexport async function fileExistsAsync(file: string): Promise<boolean> {\n  try {\n    return (await fsp.stat(file)).isFile();\n  } catch (e) {\n    return false;\n  }\n}\n\nasync function _findConfigPathAsync(projectRoot) {\n  const appJson = path.join(projectRoot, 'app.json');\n  const expJson = path.join(projectRoot, 'exp.json');\n  if (await fileExistsAsync(appJson)) {\n    return appJson;\n  } else if (await fileExistsAsync(expJson)) {\n    return expJson;\n  } else {\n    return appJson;\n  }\n}\n\nexport async function findConfigFileAsync(\n  projectRoot: string\n): Promise<{ configPath: string, configName: string, configNamespace: ?string }> {\n  let configPath;\n  if (customConfigPaths[projectRoot]) {\n    configPath = customConfigPaths[projectRoot];\n  } else {\n    configPath = await _findConfigPathAsync(projectRoot);\n  }\n  const configName = path.basename(configPath);\n  const configNamespace = configName === 'app.json' ? 'expo' : null;\n  return { configPath, configName, configNamespace };\n}\n\nexport async function configFilenameAsync(projectRoot: string): Promise<string> {\n  return (await findConfigFileAsync(projectRoot)).configName;\n}\n\nexport async function readExpRcAsync(projectRoot: string): Promise<any> {\n  const expRcPath = path.join(projectRoot, '.exprc');\n\n  if (!fs.existsSync(expRcPath)) {\n    return {};\n  }\n\n  try {\n    return await new JsonFile(expRcPath, { json5: true }).readAsync();\n  } catch (e) {\n    logError(projectRoot, 'expo', `Error parsing JSON file: ${e.toString()}`);\n    return {};\n  }\n}\n\nlet customConfigPaths = {};\n\nexport async function setCustomConfigPath(projectRoot: string, configPath: string) {\n  customConfigPaths[projectRoot] = configPath;\n}\n\nexport async function readConfigJsonAsync(\n  projectRoot: string\n): Promise<{ exp: ?Object, pkg: ?Object }> {\n  let exp;\n  let pkg;\n\n  const { configPath, configName, configNamespace } = await findConfigFileAsync(projectRoot);\n\n  try {\n    exp = await new JsonFile(configPath, { json5: true }).readAsync();\n\n    if (configNamespace) {\n      // if we're not using exp.json, then we've stashed everything under an expo key\n      // this is only for app.json at time of writing\n      exp = exp[configNamespace];\n    }\n  } catch (e) {\n    if (e.isJsonFileError) {\n      // TODO: add error codes to json-file\n      if (e.message.startsWith('Error parsing JSON file')) {\n        logError(projectRoot, 'expo', `Error parsing JSON file: ${e.cause.toString()}`);\n        return { exp: null, pkg: null };\n      }\n    }\n\n    // exp missing. might be in package.json\n  }\n\n  try {\n    const packageJsonPath =\n      exp && exp.nodeModulesPath\n        ? path.join(path.resolve(projectRoot, exp.nodeModulesPath), 'package.json')\n        : path.join(projectRoot, 'package.json');\n    pkg = await new JsonFile(packageJsonPath).readAsync();\n  } catch (e) {\n    if (e.isJsonFileError) {\n      // TODO: add error codes to json-file\n      if (e.message.startsWith('Error parsing JSON file')) {\n        logError(projectRoot, 'expo', `Error parsing JSON file: ${e.cause.toString()}`);\n        return { exp: null, pkg: null };\n      }\n    }\n\n    // pkg missing\n  }\n\n  // Easiest bail-out: package.json is missing\n  if (!pkg) {\n    logError(projectRoot, 'expo', `Error: Can't find package.json`);\n    return { exp: null, pkg: null };\n  }\n\n  // Grab our exp config from package.json (legacy) or exp.json\n  if (!exp && pkg.exp) {\n    exp = pkg.exp;\n    logError(projectRoot, 'expo', `Error: Move your \"exp\" config from package.json to exp.json.`);\n  } else if (!exp && !pkg.exp) {\n    logError(projectRoot, 'expo', `Error: Missing ${configName}. See https://docs.expo.io/`);\n    return { exp: null, pkg: null };\n  }\n\n  // fill any required fields we might care about\n\n  // TODO(adam) decide if there are other fields we want to provide defaults for\n\n  if (exp && !exp.name) {\n    exp.name = pkg.name;\n  }\n\n  if (exp && !exp.slug) {\n    exp.slug = slug(exp.name.toLowerCase());\n  }\n\n  if (exp && !exp.version) {\n    exp.version = pkg.version;\n  }\n\n  return { exp, pkg };\n}\n"],"sourceRoot":"/xdl/src"}